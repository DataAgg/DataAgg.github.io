import{v as b,b5 as T,bm as x,bn as W}from"./index.OaHEwokh.js";function E(t){const e=t.replace(/\n{2,}/g,"\n");return W(e)}function w(t){const e=E(t),{children:n}=x(e),o=[[]];let r=0;function s(t,e="normal"){"text"===t.type?t.value.split("\n").forEach(((t,n)=>{0!==n&&(r++,o.push([])),t.split(" ").forEach((t=>{t&&o[r].push({content:t,type:e})}))})):("strong"===t.type||"emphasis"===t.type)&&t.children.forEach((e=>{s(e,t.type)}))}return n.forEach((t=>{"paragraph"===t.type&&t.children.forEach((t=>{s(t)}))})),o}function v(t){const{children:e}=x(t);return e.map((function t(e){return"text"===e.type?e.value.replace(/\n/g,"<br/>"):"strong"===e.type?`<strong>${e.children.map(t).join("")}</strong>`:"emphasis"===e.type?`<em>${e.children.map(t).join("")}</em>`:"paragraph"===e.type?`<p>${e.children.map(t).join("")}</p>`:`Unsupported markdown: ${e.type}`})).join("")}function S(t){return Intl.Segmenter?[...(new Intl.Segmenter).segment(t)].map((t=>t.segment)):[...t]}function j(t,e){return g(t,[],S(e.content),e.type)}function g(t,e,n,o){if(0===n.length)return[{content:e.join(""),type:o},{content:"",type:o}];const[r,...s]=n,a=[...e,r];return t([{content:a.join(""),type:o}])?g(t,a,s,o):(0===e.length&&r&&(e.push(r),n.shift()),[{content:e.join(""),type:o},{content:n.join(""),type:o}])}function L(t,e){if(t.some((({content:t})=>t.includes("\n"))))throw new Error("splitLineToFitWidth does not support newlines in the line");return h(t,e)}function h(t,e,n=[],o=[]){if(0===t.length)return o.length>0&&n.push(o),n.length>0?n:[];let r="";" "===t[0].content&&(r=" ",t.shift());const s=t.shift()??{content:" ",type:"normal"},a=[...o];if(""!==r&&a.push({content:r,type:"normal"}),a.push(s),e(a))return h(t,e,n,a);if(o.length>0)n.push(o),t.unshift(s);else if(s.content){const[o,r]=j(e,s);n.push([o]),r.content&&t.unshift(r)}return h(t,e,n)}function $(t,e){e&&t.attr("style",e)}function k(t,e,n,o,r=!1){const s=t.append("foreignObject"),a=s.append("xhtml:div"),l=e.label,i=e.isNode?"nodeLabel":"edgeLabel";a.html(`\n    <span class="${i} ${o}" `+(e.labelStyle?'style="'+e.labelStyle+'"':"")+">"+l+"</span>"),$(a,e.labelStyle),a.style("display","table-cell"),a.style("white-space","nowrap"),a.style("max-width",n+"px"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),r&&a.attr("class","labelBkg");let c=a.node().getBoundingClientRect();return c.width===n&&(a.style("display","table"),a.style("white-space","break-spaces"),a.style("width",n+"px"),c=a.node().getBoundingClientRect()),s.style("width",c.width),s.style("height",c.height),s.node()}function m(t,e,n){return t.append("tspan").attr("class","text-outer-tspan").attr("x",0).attr("y",e*n-.1+"em").attr("dy",n+"em")}function M(t,e,n){const o=t.append("text"),r=m(o,1,e);d(r,n);const s=r.node().getComputedTextLength();return o.remove(),s}function N(t,e,n){var o;const r=t.append("text"),s=m(r,1,e);d(s,[{content:n,type:"normal"}]);const a=null==(o=s.node())?void 0:o.getBoundingClientRect();return a&&r.remove(),a}function R(t,e,n,o=!1){const r=e.append("g"),s=r.insert("rect").attr("class","background"),a=r.append("text").attr("y","-10.1");let l=0;for(const e of n){const n=e=>M(r,1.1,e)<=t,o=n(e)?[e]:L(e,n);for(const t of o){d(m(a,l,1.1),t),l++}}if(o){const t=a.node().getBBox(),e=2;return s.attr("x",-e).attr("y",-e).attr("width",t.width+2*e).attr("height",t.height+2*e),r.node()}return a.node()}function d(t,e){t.text(""),e.forEach(((e,n)=>{const o=t.append("tspan").attr("font-style","emphasis"===e.type?"italic":"normal").attr("class","text-inner-tspan").attr("font-weight","strong"===e.type?"bold":"normal");0===n?o.text(e.content):o.text(" "+e.content)}))}const H=(t,e="",{style:n="",isTitle:o=!1,classes:r="",useHtmlLabels:s=!0,isNode:a=!0,width:l=200,addSvgBackground:i=!1}={})=>{if(b.info("createText",e,n,o,r,s,a,i),s){const o=v(e);return k(t,{isNode:a,label:T(o).replace(/fa[blrs]?:fa-[\w-]+/g,(t=>`<i class='${t.replace(":"," ")}'></i>`)),labelStyle:n.replace("fill:","color:")},l,r,i)}return R(l,t,w(e),i)};export{H as a,N as c};