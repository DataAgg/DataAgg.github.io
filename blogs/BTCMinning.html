<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>比特币块链和挖矿原理(修订版) | 妙蛙云池</title>
    <meta name="description" content="专注于去中心化存储服务提供的区块链行业解决方案提供商">
    <link rel="stylesheet" href="/assets/style.45e384d0.css">
    <link rel="modulepreload" href="/assets/Home.edf45a40.js">
    <link rel="modulepreload" href="/assets/app.99e6884a.js">
    <link rel="modulepreload" href="/assets/blogs_BTCMinning.md.4f90b0e4.lean.js">
    
    <meta name="author" content="watano">
  <meta name="keywords" content="mewa,mewapool,mewa pool,filecoin,filcoin miner">
  <link rel="icon" href="/favicon.ico">
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <meta name="twitter:title" content="比特币块链和挖矿原理(修订版) | 妙蛙云池">
  <meta property="og:title" content="比特币块链和挖矿原理(修订版) | 妙蛙云池">
  </head>
  <body>
    <div id="app"><div class="theme"><header class="nav-bar" data-v-eacf8434><div class="sidebar-button" data-v-eacf8434><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="妙蛙云池, back to home" data-v-eacf8434 data-v-2e7d3e70><img class="logo" src="/logo.png" alt="Logo" data-v-2e7d3e70> 妙蛙云池</a><div class="flex-grow" data-v-eacf8434></div><div class="nav" data-v-eacf8434><nav class="nav-links" data-v-eacf8434 data-v-7c9afbaa><!--[--><div class="item" data-v-7c9afbaa><div class="nav-dropdown-link" data-v-7c9afbaa data-v-121c5160><button class="button" data-v-121c5160><span class="button-text" data-v-121c5160>产品</span><span class="right button-arrow" data-v-121c5160></span></button><ul class="dialog" data-v-121c5160><!--[--><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/products/product1" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>满存算力</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/products/product2" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>联挖整机</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-7c9afbaa><div class="nav-dropdown-link" data-v-7c9afbaa data-v-121c5160><button class="button" data-v-121c5160><span class="button-text" data-v-121c5160>行业解决方案</span><span class="right button-arrow" data-v-121c5160></span></button><ul class="dialog" data-v-121c5160><!--[--><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/service/intro" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>综述</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/service/solution1" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>生鲜配送</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/service/solution2" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>诊所联盟</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-7c9afbaa><div class="nav-dropdown-link" data-v-7c9afbaa data-v-121c5160><button class="button" data-v-121c5160><span class="button-text" data-v-121c5160>DeFi</span><span class="right button-arrow" data-v-121c5160></span></button><ul class="dialog" data-v-121c5160><!--[--><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/defi/ohmCalc" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>OlympusDAO计算器</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/defi/timeCalc" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>Wonderland计算器</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-7c9afbaa><div class="nav-dropdown-link" data-v-7c9afbaa data-v-121c5160><button class="button" data-v-121c5160><span class="button-text" data-v-121c5160>关于我们</span><span class="right button-arrow" data-v-121c5160></span></button><ul class="dialog" data-v-121c5160><!--[--><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/other/teams" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>公司与团队</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/other/story" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>成功案例</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><!--]--></ul></div></div><!--]--><!----><!----><div class="item" data-v-7c9afbaa><button class="nav-btn" aria-label="Toggle Theme" data-v-7c9afbaa><svg width="1.2em" height="1.2em" preserveaspectratio="xMidYMid meet" viewbox="0 0 24 24" style="display:none;"><path d="M21.64 13a1 1 0 0 0-1.05-.14a8.05 8.05 0 0 1-3.37.73a8.15 8.15 0 0 1-8.14-8.1a8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69a1 1 0 0 0-.36-1.05zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14a9.79 9.79 0 0 0 2.1-.22a8.11 8.11 0 0 1-7.18 4.32z" fill="currentColor"></path></svg><svg width="1.2em" height="1.2em" preserveaspectratio="xMidYMid meet" viewbox="0 0 24 24" style=""><path d="M5.64 17l-.71.71a1 1 0 0 0 0 1.41a1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17zM5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1zm7-7a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1zM5.64 7.05a1 1 0 0 0 .7.29a1 1 0 0 0 .71-.29a1 1 0 0 0 0-1.41l-.71-.71a1 1 0 0 0-1.41 1.41zm12 .29a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.64.71a1 1 0 0 0 0 1.41a1 1 0 0 0 .66.29zM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2zm-9 8a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1zm6.36-2A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0a1 1 0 0 0 0-1.41zM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5zm0 9a3.5 3.5 0 1 1 3.5-3.5a3.5 3.5 0 0 1-3.5 3.5z" fill="currentColor"></path></svg></button></div></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-34e9bec6><nav class="nav-links nav" data-v-34e9bec6 data-v-7c9afbaa><!--[--><div class="item" data-v-7c9afbaa><div class="nav-dropdown-link" data-v-7c9afbaa data-v-121c5160><button class="button" data-v-121c5160><span class="button-text" data-v-121c5160>产品</span><span class="right button-arrow" data-v-121c5160></span></button><ul class="dialog" data-v-121c5160><!--[--><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/products/product1" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>满存算力</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/products/product2" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>联挖整机</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-7c9afbaa><div class="nav-dropdown-link" data-v-7c9afbaa data-v-121c5160><button class="button" data-v-121c5160><span class="button-text" data-v-121c5160>行业解决方案</span><span class="right button-arrow" data-v-121c5160></span></button><ul class="dialog" data-v-121c5160><!--[--><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/service/intro" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>综述</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/service/solution1" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>生鲜配送</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/service/solution2" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>诊所联盟</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-7c9afbaa><div class="nav-dropdown-link" data-v-7c9afbaa data-v-121c5160><button class="button" data-v-121c5160><span class="button-text" data-v-121c5160>DeFi</span><span class="right button-arrow" data-v-121c5160></span></button><ul class="dialog" data-v-121c5160><!--[--><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/defi/ohmCalc" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>OlympusDAO计算器</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/defi/timeCalc" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>Wonderland计算器</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-7c9afbaa><div class="nav-dropdown-link" data-v-7c9afbaa data-v-121c5160><button class="button" data-v-121c5160><span class="button-text" data-v-121c5160>关于我们</span><span class="right button-arrow" data-v-121c5160></span></button><ul class="dialog" data-v-121c5160><!--[--><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/other/teams" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>公司与团队</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><li class="dialog-item" data-v-121c5160><div class="nav-dropdown-link-item" data-v-121c5160 data-v-17dca46e><a class="item" href="/other/story" data-v-17dca46e><span class="arrow" data-v-17dca46e></span><span class="text" data-v-17dca46e>成功案例</span><span class="icon" data-v-17dca46e><!----></span></a></div></li><!--]--></ul></div></div><!--]--><!----><!----><div class="item" data-v-7c9afbaa><button class="nav-btn" aria-label="Toggle Theme" data-v-7c9afbaa><svg width="1.2em" height="1.2em" preserveaspectratio="xMidYMid meet" viewbox="0 0 24 24" style="display:none;"><path d="M21.64 13a1 1 0 0 0-1.05-.14a8.05 8.05 0 0 1-3.37.73a8.15 8.15 0 0 1-8.14-8.1a8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69a1 1 0 0 0-.36-1.05zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14a9.79 9.79 0 0 0 2.1-.22a8.11 8.11 0 0 1-7.18 4.32z" fill="currentColor"></path></svg><svg width="1.2em" height="1.2em" preserveaspectratio="xMidYMid meet" viewbox="0 0 24 24" style=""><path d="M5.64 17l-.71.71a1 1 0 0 0 0 1.41a1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17zM5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1zm7-7a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1zM5.64 7.05a1 1 0 0 0 .7.29a1 1 0 0 0 .71-.29a1 1 0 0 0 0-1.41l-.71-.71a1 1 0 0 0-1.41 1.41zm12 .29a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.64.71a1 1 0 0 0 0 1.41a1 1 0 0 0 .66.29zM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2zm-9 8a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1zm6.36-2A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0a1 1 0 0 0 0-1.41zM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5zm0 9a3.5 3.5 0 1 1 3.5-3.5a3.5 3.5 0 0 1-3.5 3.5z" fill="currentColor"></path></svg></button></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-34e9bec6><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="#译者前言">译者前言</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#正文">正文</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_1-区块-block">1.区块(Block)</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#_1-1-区块结构-block-structure">1.1 区块结构(Block Structure)</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_1-2-详细说明-explanation">1.2 详细说明(Explanation)</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_2-创世块-genesis-block">2.创世块(Genesis Block)</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_3-块链-block-chain">3.块链(Block Chain)</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_4-区块-hash-算法-block-hashing-algorithm">4.区块 HASH 算法(Block hashing Algorithm)</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_5-难度-difficulty">5.难度(Difficulty)</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#本文译自比特币-wiki">本文译自比特币 WIKI</a><!----></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-3343bde8><div class="container" data-v-3343bde8><!--[--><!--]--><div style="position:relative;" class="content" data-v-3343bde8><div><h1 id="比特币块链和挖矿原理-修订版" tabindex="-1">比特币块链和挖矿原理(修订版) <a class="header-anchor" href="#比特币块链和挖矿原理-修订版" aria-hidden="true" target="_blank" rel="noopener">#</a></h1><p><a href="http://www.8btc.com/bitcoin_block_chain" target="_blank" rel="noopener noreferrer">原文</a> 排版实在是惨不忍睹,所以手工校正了一下,方便大家阅读,如果侵权请及时联系我,我立即撤稿.</p><hr><p>译者：申屠青春　深圳大学 ATR 国防科技重点实验室博士　新浪微博　@我看比特币</p><p>注意：本文可随意转发，请留下译者信息，如果觉得本文对你有用，请给译者捐赠，以便翻译更多比特币的核心资料。捐赠地址：<code>1faVxBp2KmST98p3tJjx2MQP98JLLnF2Q</code></p><h2 id="译者前言" tabindex="-1">译者前言 <a class="header-anchor" href="#译者前言" aria-hidden="true" target="_blank" rel="noopener">#</a></h2><p>​ 比特币在国内已经众所周知，但是技术研究并未有效开展，大部分人处于知道和了解程度，目前比特圈中许多人对比特币能做什么，同样了解不多。一个重要原因是大多数比特币核心资料都是英文，很少有人能静心看完如此繁杂的英文资料。本人博士论文的研究方向是比特币，在研究其英文技术的同时，拟对一些重要资料进行翻译，让更多的圈内人对比特币有更多的理解。</p><p>​ 本文主题是比特币区块、创世块、挖矿原理、难度等的技术资料，综合了比特币官方威客上的众多资料翻译和编写而成。</p><h2 id="正文" tabindex="-1">正文 <a class="header-anchor" href="#正文" aria-hidden="true" target="_blank" rel="noopener">#</a></h2><h2 id="_1-区块-block" tabindex="-1">1.区块(Block) <a class="header-anchor" href="#_1-区块-block" aria-hidden="true" target="_blank" rel="noopener">#</a></h2><p>​ 比特币网络中，数据以文件的形式被永久记录，我们称之为区块。一个区块是一些或所有最新比特币交易的记录集，且未被其他先前的区块记录。区块可以想像为一个城市记录者的记录本上的单独一页纸(对房地产产权的变更记录)或者是股票交易所的总帐本。在绝大多数情况下，新区块被加入到记录最后(在比特币中的名称为：<a href="https://en.bitcoin.it/wiki/Block_chain" target="_blank" rel="noopener noreferrer">块链</a>，一旦写上，就再也不能改变或删除。每个区块记录了它被创建之前发生的所有事件。</p><h3 id="_1-1-区块结构-block-structure" tabindex="-1">1.1 区块结构(Block Structure) <a class="header-anchor" href="#_1-1-区块结构-block-structure" aria-hidden="true" target="_blank" rel="noopener">#</a></h3><table><thead><tr><th><strong>数据项</strong></th><th><strong>描述</strong></th><th><strong>长度</strong></th></tr></thead><tbody><tr><td>Magic no 魔术数</td><td>总是 0xD9B4BEF9</td><td>4 字节</td></tr><tr><td>Blocksize 块大小</td><td>到区块结束的字节长度</td><td>4 字节</td></tr><tr><td>Blockheader 块头</td><td><a href="https://en.bitcoin.it/wiki/Block_hashing_algorithm" target="_blank" rel="noopener noreferrer">包含 6 个数据项</a></td><td>80 字节</td></tr><tr><td>Transaction counter 交易数量</td><td>正整数 <a href="https://en.bitcoin.it/wiki/Protocol_specification#Variable_length_integer" target="_blank" rel="noopener noreferrer">VI = VarInt</a></td><td>1 – 9 字节</td></tr><tr><td><a href="https://en.bitcoin.it/wiki/Transactions" target="_blank" rel="noopener noreferrer">transactions</a> 交易</td><td>交易列表(非空)</td><td>&lt;Transaction counter&gt;-许多交易</td></tr></tbody></table><h3 id="_1-2-详细说明-explanation" tabindex="-1">1.2 详细说明(Explanation) <a class="header-anchor" href="#_1-2-详细说明-explanation" aria-hidden="true" target="_blank" rel="noopener">#</a></h3><p>​ 每个区块包括一些或所有近期交易、前一个区块的引用、以及其他数据。它还包括一个挖矿难度的答案-该答案对每个区块是唯一的。新区块如果没有正确答案，不能被发送到网络中-“<a href="https://en.bitcoin.it/wiki/Mining" target="_blank" rel="noopener noreferrer">挖矿</a>”的过程本质上是在竞争中 “解决”当前区块。每个区块中的数学问题难以解决，但是一旦发现了一个有效解，其他网络节点很容易验证这个解的正确性，对于给定的区块可能有多个有效解-但对于要解决的区块来说只需一个解。</p><p>​ 因为每解决一个区块，都会得到新产生的比特币奖励，每个区块包含一个记录，记录中的<a href="https://en.bitcoin.it/wiki/Bitcoin_address" target="_blank" rel="noopener noreferrer">比特币地址</a>是有权获得比特币奖励的地址。这个纪录被称为生产交易、或者<a href="https://en.bitcoin.it/wiki/Coinbase" target="_blank" rel="noopener noreferrer">coinbase</a>交易，它经常是每个区块的第一个交易。每个块区生产的比特币数量是 50 个，每产生 21 万个区块后减少一半（时间大约是 4 年）。</p><p>​ 发送者在网络中广播比特币交易，所有试图解决区块的矿工节点，收集了这些交易记录，把它们加到矿工节点正在解决的区块中。</p><p>​ 挖矿难度由比特币网络自动调整，使之实现平均每小时解决 6 个区块的目标。每 2016 个区块（大约两周）后，所有客户端把新区块的实际数目与目标数量相比较，并且按照差异的百分比调整目标 HASH 值，来增加（或降低）产生区块的难度。</p><p>​ 因为所有区块包含前一个区块的引用，现存的所有区块的集合可以说是形成了一条链，然而，块链有可能产生暂时分叉-举个例子，如果两个矿工同时为一个区块产生不同的有效解，两者相互不知。P2P 网络会在一段短时间内消除这些分叉，该链仅有一个分支存活。</p><p>​ 客户端接受“最长”块链作为有效链，整条块链的“<a href="https://en.bitcoin.it/wiki/Block_chain" target="_blank" rel="noopener noreferrer">长度</a>”是指具有最大难度的链，而不是指具有最多区块数量的块链，可防止某些人创建大量低难度区块，故意使块链分叉，并且让网络接受它成为“最长”的块链。</p><p>（译者按：以下非标准区块内容来自<a href="https://en.bitcoin.it/wiki/Nonstandard_block" target="_blank" rel="noopener noreferrer">Nonstandard_block</a> ，略有改动）</p><p>​ 非标准区块：是指包括非标准交易的区块，交易的标准与否，要参考比特币客户端源代码中的 <code>IsStandard()</code>函数。客户端不会传播非标准交易，但是某些矿池的矿工会把合法的非标准交易加入到区块中，形成非标准区块，客户端在计算难度最长的块链时，会考虑非标准区块。</p><h4 id="区块的一般问题" tabindex="-1">区块的一般问题 <a class="header-anchor" href="#区块的一般问题" aria-hidden="true" target="_blank" rel="noopener">#</a></h4><ul><li><p>(1)目前有多少个区块？</p><p><a href="http://blockexplorer.com/q/getblockcount" target="_blank" rel="noopener noreferrer">目前的区块数</a>，访问：<a href="http://blockexplorer.com/q/getblockcount" target="_blank" rel="noopener noreferrer">getblockcount</a></p></li><li><p>(2)区块的最大数量是多少？</p><p>没有最大数量，区块以平均每 10 分钟一个的速度，源源不断地加到块链结尾。</p></li><li><p>(3)甚至当所有的 2100 万个比特币全部被挖完，还是没有最大数量吗？</p><p>对的，区块用来确认交易在某一特定时间存在，即使比特币全部被挖完，交易还是会发生，所以只要人们还在交易比特币，区块还会被创建。</p></li><li><p>(4)我要花多少时间生成一个区块？</p><p>没有人能够准确回答，这里有个<a href="https://en.bitcoin.it/wiki/Generation_Calculator" target="_blank" rel="noopener noreferrer">生产计算器</a> ，可以告诉你可能要花多少时间。</p></li><li><p>(5)如果我完成计算一个区块的 1%进度…</p><p>没有解决一个区块的 1%的说法，你不会在解决区块上有任何进展，在工作 24 小时后，你解决一个区块的机率和 24 小时前一样，若非信仰比特币就是众所周知的赌徒谬误。</p><p>这就像同时抛 53 枚硬币，使得它们人头向上，每次你试验，你的成功机率都是一样的。</p></li><li><p>(6)我还能找到更多的技术细节吗？</p><p>在下面的<a href="https://en.bitcoin.it/wiki/Block_hashing_algorithm" target="_blank" rel="noopener noreferrer">区块 HASH 算法</a>中，有更多的技术细节。</p></li></ul><h2 id="_2-创世块-genesis-block" tabindex="-1">2.创世块(Genesis Block) <a class="header-anchor" href="#_2-创世块-genesis-block" aria-hidden="true" target="_blank" rel="noopener">#</a></h2><p>​ 创世块是指块链的第一个块，现在的比特币客户端版本把块号定为 0，以前的版本把该块块号定为 1。</p><p>​ 以下是创世块的一种表示，它出现在以前的比特币代码的注释中(<a href="http://sourceforge.net/p/bitcoin/code/133/tree/trunk/main.cpp#l1613" target="_blank" rel="noopener noreferrer">第 1613 行</a>)，第一个代码段定义了创建该块所需的所有变量，第二个代码段是标准的区块类格式，还包含了第一个代码段中缩短版本的数据。</p><div class="language-cpp line-numbers-mode"><pre><code><span class="token function">GetHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token number">0x000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f</span>
hashMerkleRoot <span class="token operator">=</span> <span class="token number">0x4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b</span>
txNew<span class="token punctuation">.</span>vin<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>scriptSig     <span class="token operator">=</span> <span class="token number">486604799</span> <span class="token number">4</span> <span class="token number">0x736B6E616220726F662074756F6C69616220646E6F63657320666F206B6E697262206E6F20726F6C6C65636E61684320393030322F6E614A2F33302073656D695420656854</span>
txNew<span class="token punctuation">.</span>vout<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nValue       <span class="token operator">=</span> <span class="token number">5000000000</span>
txNew<span class="token punctuation">.</span>vout<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>scriptPubKey <span class="token operator">=</span>
<span class="token number">0x5F1DF16B2B704C8A578D0BBAF74D385CDE12C11EE50455F3C438EF4C3FBCF649B6DE611FEAE06279A60939E028A8D65C10B73071A6F16719274855FEB0FD8A6704</span> OP_CHECKSIG

block<span class="token punctuation">.</span>nVersion <span class="token operator">=</span> <span class="token number">1</span>
block<span class="token punctuation">.</span>nTime    <span class="token operator">=</span> <span class="token number">1231006505</span>
block<span class="token punctuation">.</span>nBits    <span class="token operator">=</span> <span class="token number">0x1d00ffff</span>
block<span class="token punctuation">.</span>nNonce   <span class="token operator">=</span> <span class="token number">2083236893</span>

<span class="token function">CBlock</span><span class="token punctuation">(</span>hash<span class="token operator">=</span><span class="token number">000000000019</span>d6<span class="token punctuation">,</span> ver<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> hashPrevBlock<span class="token operator">=</span><span class="token number">00000000000000</span><span class="token punctuation">,</span> hashMerkleRoot<span class="token operator">=</span><span class="token number">4</span>a5e1e<span class="token punctuation">,</span> nTime<span class="token operator">=</span><span class="token number">1231006505</span><span class="token punctuation">,</span> nBits<span class="token operator">=</span><span class="token number">1</span>d00ffff<span class="token punctuation">,</span> nNonce<span class="token operator">=</span><span class="token number">2083236893</span><span class="token punctuation">,</span> vtx<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token function">CTransaction</span><span class="token punctuation">(</span>hash<span class="token operator">=</span><span class="token number">4</span>a5e1e<span class="token punctuation">,</span> ver<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> vin<span class="token punctuation">.</span>size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> vout<span class="token punctuation">.</span>size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> nLockTime<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token function">CTxIn</span><span class="token punctuation">(</span><span class="token function">COutPoint</span><span class="token punctuation">(</span><span class="token number">000000</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> coinbase <span class="token number">04ffff</span>001d0104455468652054696d65732030332f4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73<span class="token punctuation">)</span>

<span class="token function">CTxOut</span><span class="token punctuation">(</span>nValue<span class="token operator">=</span><span class="token number">50.00000000</span><span class="token punctuation">,</span> scriptPubKey<span class="token operator">=</span><span class="token number">0x5F1DF16B2B704C8A578D0B</span><span class="token punctuation">)</span>

vMerkleTree<span class="token operator">:</span> <span class="token number">4</span>a5e1e
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>coinbase 参数(看上面的十六进制)包含了以下一段话：</p><p><code>The Times 03/Jan/2009 Chancellor on brink of second bailout for banks</code></p><p><a href="http://7fvhfe.com1.z0.glb.clouddn.com/wp-content/uploads/2014/03/221.jpg" target="_blank" rel="noopener noreferrer"><img src="http://7fvhfe.com1.z0.glb.clouddn.com/wp-content/uploads/2014/03/221.jpg" alt="22"></a></p><p>​ “2009 年 1 月 3 日，首相第二次对处于崩溃边缘的银行进行紧急救助”，这句话正是<a href="http://zh.wikipedia.org/wiki/%E6%B3%B0%E6%99%A4%E5%A3%AB%E6%8A%A5" target="_blank" rel="noopener noreferrer">泰晤士报</a>当天的头版文章标题。这应该是一个该区块在 2009 年 1 月 3 日或之后创建的一个证据，同时也是对银行系统采用部分准备金制度导致不稳定性的一个说明。</p><p>​ 创世块的收益不可能被花掉，因为创世块是用代码表示的(这个巧合可能是故意的)，尽管如此，其 50BTC 收益还是被发送到地址：<a href="http://blockexplorer.com/address/1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa" target="_blank" rel="noopener noreferrer">1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa</a>。</p><p>​ (译者按：创世块的收益花不掉，原因如下：比特币客户端把区块和交易分开存贮在两个数据库中，当客户端发现区块数据库为空时，用代码直接生成一个创世块，但是没有生成这个交易，所以客户端中的交易数据库中是没有发送到上述地址这个交易的，因而一旦收到要花掉该收益的交易时，都会拒绝，所以无法得到任何确认，就花不掉这 50 个币。出现这种情况很可能是中本聪故意的。)</p><p>原始区块数据</p><p>​ 创世块的原始十六进制如下所示：</p><div class="language-"><pre><code>00000000   01 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   …………….
00000010   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   …………….
00000020   00 00 00 00 3B A3 ED FD  7A 7B 12 B2 7A C7 2C 3E   ….;£íýz{.²zÇ,&gt;
00000030   67 76 8F 61 7F C8 1B C3  88 8A 51 32 3A9F B8 AA   gv.a.È.ÃˆŠQ2:Ÿ¸ª
00000040   4B 1E 5E 4A 29 AB 5F 49  FF FF 00 1D 1D AC 2B 7C   K.^J)«_Iÿÿ…¬+|
00000050   01 01 00 00 00 01 00 00  00 00 00 00 00 00 00 00   …………….
00000060   00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00   …………….
00000070   00 00 00 00 00 00 FF FF  FF FF 4D 04 FF FF 00 1D   ……ÿÿÿÿM.ÿÿ..
00000080   01 04 45 54 68 65 20 54  69 6D 65 73 20 30 33 2F   ..EThe Times 03/
00000090   4A 61 6E 2F 32 30 30 39  20 43 68 61 6E 63 65 6C   Jan/2009 Chancel
000000A0   6C6F 72 20 6F 6E 20 62  72 69 6E 6B 20 6F 66 20   lor on brink of
000000B0   73 65 63 6F 6E 64 20 62  61 69 6C6F 75 74 20 66   second bailout f
000000C0   6F 72 20 62 61 6E 6B 73  FF FF FF FF 01 00 F2 05   or banksÿÿÿÿ..ò.
000000D0   2A 01 00 00 00 43 41 04  67 8A FD B0 FE 55 48 27   *….CA.gŠý°þUH’
000000E0   19 67 F1 A6 71 30 B7 10  5C D6 A8 28 E0 39 09 A6   .gñ¦q0·.\Ö¨(à9.¦
000000F0   79 62 E0 EA 1F 61 DE B6  49 F6 BC 3F4C EF 38 C4   ybàê.aÞ¶Iö¼?Lï8Ä
00000100   F3 55 04 E5 1E C1 12 DE  5C 38 4D F7 BA 0B 8D 57   óU.å.Á.Þ\8M÷º..W
00000110   8A4C 70 2B 6B F1 1D 5F  AC 00 00 00 00            ŠLp+kñ._¬….
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>分开来看，如下所示：</p><div class="language-"><pre><code>01000000 – 版本号
0000000000000000000000000000000000000000000000000000000000000000 – prev block
3BA3EDFD7A7B12B27AC72C3E67768F617FC81BC3888A51323A9FB8AA4B1E5E4A – merkle root
29AB5F49 – 时间戳
FFFF001D – 目标HASH值
1DAC2B7C – 随机数
01 – 交易个数
01000000 – 版本
01 – 输入
0000000000000000000000000000000000000000000000000000000000000000FFFFFFFF – 前一个输出
4D – 脚本长度
04FFFF001D0104455468652054696D65732030332F4A616E2F32303039204368616E63656C6C6F72206F6E206272696E6B206F66207365636F6E64206261696C6F757420666F722062616E6B73 – scriptsig脚本
FFFFFFFF – 序列号
01 – 输出
00F2052A01000000 – 50 BTC的收益
43 – 脚本scriptPubKey的长度
4104678AFDB0FE5548271967F1A67130B7105CD6A828E03909A67962E0EA1F61DEB649F6BC3F4CEF38C4F35504E51EC112DE5C384DF7BA0B8D578A4C702B6BF11D5FAC – 脚本scriptPubKey
00000000 –锁定时间
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>JSON 版本的创世块如下所示(译者按：JSON 表示方式是译者加的，方便读者对照研究)：</p><div class="language-json line-numbers-mode"><pre><code><span class="token punctuation">{</span>
  <span class="token property">&quot;hash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;ver&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">&quot;prev_block&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0000000000000000000000000000000000000000000000000000000000000000&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;mrkl_root&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;time&quot;</span><span class="token operator">:</span> <span class="token number">1231006505</span><span class="token punctuation">,</span>
  <span class="token property">&quot;bits&quot;</span><span class="token operator">:</span> <span class="token number">486604799</span><span class="token punctuation">,</span>
  <span class="token property">&quot;nonce&quot;</span><span class="token operator">:</span> <span class="token number">2083236893</span><span class="token punctuation">,</span>
  <span class="token property">&quot;n_tx&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">285</span><span class="token punctuation">,</span>
  <span class="token property">&quot;tx&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;hash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;ver&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;vin_sz&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;vout_sz&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;lock_time&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token property">&quot;size&quot;</span><span class="token operator">:</span> <span class="token number">204</span><span class="token punctuation">,</span>
      <span class="token property">&quot;in&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;prev_out&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;hash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0000000000000000000000000000000000000000000000000000000000000000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;n&quot;</span><span class="token operator">:</span> <span class="token number">4294967295</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token property">&quot;coinbase&quot;</span><span class="token operator">:</span> <span class="token string">&quot;04ffff001d0104455468652054696d65732030332f4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;out&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;50.00000000&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;scriptPubKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;04678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5f OP_CHECKSIG&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;mrkl_tree&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h2 id="_3-块链-block-chain" tabindex="-1">3.块链(Block Chain) <a class="header-anchor" href="#_3-块链-block-chain" aria-hidden="true" target="_blank" rel="noopener">#</a></h2><p>​ 块链是所有<a href="https://en.bitcoin.it/wiki/Node" target="_blank" rel="noopener noreferrer">比特币节点</a>共享的交易数据库，这些节点基于比特币协议参与到比特币网络中来。块链包含每一个曾在比特币系统执行过的<a href="https://en.bitcoin.it/wiki/Transaction" target="_blank" rel="noopener noreferrer">交易</a>。根据这个信息，人们可以找到任何时候任一个<a href="https://en.bitcoin.it/wiki/Address" target="_blank" rel="noopener noreferrer">地址</a>中的币数量，</p><p>​ 每个区块包含前一个区块的<a href="https://en.bitcoin.it/wiki/Hash" target="_blank" rel="noopener noreferrer">HASH</a>值，这就使得从<a href="https://en.bitcoin.it/wiki/Genesis_block" target="_blank" rel="noopener noreferrer">创世块</a>到当前块形成了一条块链，每个区块必定按时间顺序跟随在前一个区块之后，因为如果不知道前一块区块的 HASH 值就没法生成当前区块。要改变一个已经在块链中存在一段时间的区块，从计算上来说是不可行的，因为如果它被改变，它之后的每个区块必须随之改变。这些特性使得<a href="https://en.bitcoin.it/wiki/Double-spending" target="_blank" rel="noopener noreferrer">双花</a>比特币非常困难，块链是比特币的最大创新。</p><p>​ 如果一个区块是最长块链的最后一个区块，诚实的矿工只会在这个区块基础生成后续块(创建新块时通过引用该块来实现)。“长度”是被计算成块链的所有联合难度，而不是区块数目，尽管这个区别仅仅在防御几个潜在攻击时有用。如果一个块链中的所有区块和交易有效，则该块链有效，并且要以创世块开头。</p><p>​ 对于块链中的任何区块来说，只有一条通向创世块的路径。然而，从创世块出发，却可能有分叉。当两个区块产生的时间仅相差几秒时，可能会产生包含一个区块的分叉。当以上现象出现时，矿工节点会根据收到区块的时间，在先收到的区块基础上继续挖矿。哪个区块的后续区块先出现，这个区块就被包括进主链，因为这条块链更长。在修正需要向后兼容的程序 BUG 后，出现过更严重的分叉。</p><p>​ 短块链(或有效块链)中的区块没有作用，当比特币客户端转向另一个长块链时，短块链中所有有效的交易将被重新加入到交易队列池中，将被包括中另一个块中。短块链中的区块收益不会在长链中出现，因而这些收益实际上是丢失了，这就是比特币网络强化的 100 个区块成熟时间的存在原因。</p><p>​ 在短块链中的区块经常被称为“孤立”区块，这是因为在长块链中的生产交易没有父区块，因而这些生产交易在交易列表的 RPC 调用中表现为孤立。几个矿池误解了这些信息并且把这些区块叫作“孤儿”，事实上这些区块都有父区块，可能还有子区块。</p><p>​ 因为一个区块只能引用一个父区块，因而不可能把两个已经分叉的块链合并。</p><p>​ 可以把块链算法用于非金融目的，请看：<a href="https://en.bitcoin.it/wiki/Alternative_chain" target="_blank" rel="noopener noreferrer">山寨块链</a> <a href="https://en.bitcoin.it/wiki/Alternative_chain" target="_blank" rel="noopener noreferrer">https://en.bitcoin.it/wiki/Alternative_chain</a>。</p><p>​ 块链以洪水协议被广播到网络上的所有节点，请看：<a href="https://en.bitcoin.it/wiki/Block_chain_download" target="_blank" rel="noopener noreferrer">块链下载</a></p><p>​ 译者按：区块成熟时间(Maturation Time)，是指矿工产生一个新区块得到 25BTC 收益后，要等过了 100 个块后，才能使用这些币；这个 100 区块时间，即收到 100 个确认的时间，就是区块成熟时间。为什么要设这个时间？如果这个区块在分叉时变成了孤立区块，25 个 BTC 的收益将消失，如果矿工挖到比特币后可以马上花掉，就会造成后续的一系列接收者损失比特币，因而设定了 100 个确认的限制，在这之后产生分叉的可能性非常小，即使产生分叉，也只会影响矿工收益，不会影响到其他人。</p><h2 id="_4-区块-hash-算法-block-hashing-algorithm" tabindex="-1">4.区块 HASH 算法(Block hashing Algorithm) <a class="header-anchor" href="#_4-区块-hash-算法-block-hashing-algorithm" aria-hidden="true" target="_blank" rel="noopener">#</a></h2><p>当挖矿时，你会经常对区块头进行 HASH，你正在挖的区块也会时常更新，一个区域头包含以下数据项：</p><table><thead><tr><th><strong>数据项****</strong></th><th><strong>目的</strong></th><th><strong>更新时间****</strong></th><th><strong>大小****</strong></th></tr></thead><tbody><tr><td>Version 版本</td><td>区域版本号</td><td>更新软件后，它指定了一个新版本号</td><td>4</td></tr><tr><td>hashPrevBlock 前一区块的 HASH</td><td>前一区块的 256 位 HASH 值</td><td>新的区块进来时</td><td>32</td></tr><tr><td>hashMerkleRoot<a href="https://en.bitcoin.it/wiki/Protocol_specification" target="_blank" rel="noopener noreferrer">Merkele 根节点</a>HASH 值</td><td>基于一个区块中所有交易的 256 位 HASH 值。</td><td>接受一个交易时</td><td>32</td></tr><tr><td>Time 时间戳</td><td>从 1970-01-01 00:00 UTC 开始到现在，以秒为单位的当前时间戳</td><td>每几秒就更新</td><td>4</td></tr><tr><td>Bits 当前目标 HASH 值</td><td>压缩格式的当前<a href="https://en.bitcoin.it/wiki/Target" target="_blank" rel="noopener noreferrer">目标 HASH 值</a></td><td>当<a href="https://en.bitcoin.it/wiki/Difficulty" target="_blank" rel="noopener noreferrer">挖矿难度</a>调整时</td><td>4</td></tr><tr><td>Nonce 随机数</td><td>从 0 开始的 32 位随机</td><td>产生 HASH 时 A (每次产生 HASH 随机数要增长)</td><td>4</td></tr></tbody></table><p>​ 区块内包含许多交易，它们通过 Merkle 根节点间接被 HASH，因为所有交易不可能直接被 HASH，HASH 包含一个交易的区块所花的时间，和 HASH 包含 1 万个交易的区块一样。</p><p>​ 目标 HASH 值的压缩格式是一个特殊的浮点编码类型，首字节是指数(仅使用了 5 个最低位)，后 3 个字节是尾数，它能表示 256 位的数值。一个区块头的 SHA256 值必定要小于或等于目标 HASH 值，该区块才能被网络所接受，目标 HASH 越低，产生一个新区块的难度越大。</p><p>​ 上述大部分数据项对所有用户是一致的，可能在时间戳上有些区别。(译者按：该段的以下内容来自：)如果当前区块的时间戳大于前 11 个区块的的平均时间戳，并且小于“网络调整时间(Network-Adjusted Time)”+2 小时，则认为该时间戳是有效的。其中的“网络调整时间”是指与你相连接的所有节点的平均时间。当节点 A 连接到节点 B 时，A 从 B 处得到一个 UTC 标准的时间戳，A 先转换成本地 UTC 标准时间保存起来，网络调整时间等于所有节点的本地 UTC 时间+所有相连节点的偏移量平均值，然而，该网络时间永远不会调整到超过本地系统时间 70 分钟以上。</p><p>​ Nonce 随机数通常不同，但是它以严格的线性方式增长，从 0 开始，每次 HASH 时都会增长，当 Nonce 溢出时(此事经常发生)，生产交易的 extraNonce 项会增长，将改变 Merkle 树的根节点。</p><p>​ 假定针对这些数据项，人们经常会独自产生同样序列号的 HASH 值，最快的 CPU 通常会赢。然而，两人产生同样的 Merkle 根节点基本是(或近似)不可能的，因为区块中的第一个交易是生产交易并且“发送”到你的独一无二的比特币地址。因为你的区块与其他人的区块不同，产生的 HASH 也肯定(近似肯定)不同，你计算的每个 HASH 和网络中的其他人一样，都有同样的获胜机会。</p><p>​ 比特币使用：SHA256(SHA256(区块头))计算 HASH，但你要注意字节序。</p><p>​ 例如：以下 python 代码用于计算某一区块的 HASH 值，使用 2011 年 6 月的区块号 125552 的最小 HASH 值。该区块头建立上述 6 个数据项之上，并且以十六进制的小端结尾方式连接在一起。</p><div class="language-python line-numbers-mode"><pre><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> hashlib
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> header_hex <span class="token operator">=</span> <span class="token punctuation">(</span>“<span class="token number">01000000</span>″ <span class="token operator">+</span>
“81cd02ab7e569e8bcd9317e2fe99f2de44d49ab2b8851ba4a308000000000000″ <span class="token operator">+</span>
“e320b6c2fffc8d750423db8b1eb942ae710e951ed797f7affc8892b0f1fc122b” <span class="token operator">+</span>
“c7f5d74d” <span class="token operator">+</span>
“f2b9441a” <span class="token operator">+</span>
“42a14695″<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> header_bin <span class="token operator">=</span> header_hex<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>‘<span class="token builtin">hex</span>’<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">hash</span> <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>header_bin<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">hash</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span>‘hex_codec’<span class="token punctuation">)</span>
’1dbd981fe6985776b644b173a4d0385ddc1aa2a829688d1e0000000000000000′
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">hash</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span>‘hex_codec’<span class="token punctuation">)</span>
’00000000000000001e8d6829a8a21adc5d38d0a473b144b6765798e61f98bd1d’
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>​ 注意：实际的 HASH 值是一串 256 位的数值，首部有许多零。当以大头端十六进制常数方式打印或存贮时，它的首部有许多零；如果它以小头端打印或存贮，零就会变换到尾部。例如：如果表示成字节串-最低(或者开头)的字节串地址显示最小位的数，这样就是小头端表示。<a href="http://blockexplorer.com/" target="_blank" rel="noopener noreferrer">blockexplorer</a>的输出把 HASH 值显示为大头端表示的数值，因为数字的表示通常是-首部数字是最大数字，从左向右读。</p><p>举另外一个例子：<a href="http://pastebin.com/bW3fQA2a" target="_blank" rel="noopener noreferrer">这儿</a>是纯 C 版本，未进行任何优化、线程化和错误检查。</p><p>以下是同样的例子，用 PHP 写，没有任何优化。</p><div class="language-php line-numbers-mode"><pre><code><span class="token php language-php"><span class="token delimiter important">&lt;?</span>
<span class="token comment">//This reverses and then swaps every other char</span>
<span class="token keyword">function</span> <span class="token function-definition function">SwapOrder</span><span class="token punctuation">(</span><span class="token variable">$in</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token variable">$Split</span> <span class="token operator">=</span> <span class="token function">str_split</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$in</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$x</span><span class="token operator">=</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$Split</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">+=</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token variable">$x</span> <span class="token operator">.=</span> <span class="token variable">$Split</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$Split</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token variable">$x</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//makes the littleEndian</span>
<span class="token keyword">function</span> <span class="token function-definition function">littleEndian</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token function">implode</span> <span class="token punctuation">(</span><span class="token function">unpack</span><span class="token punctuation">(</span>‘<span class="token constant">H</span><span class="token operator">*</span>’<span class="token punctuation">,</span><span class="token function">pack</span><span class="token punctuation">(</span>“<span class="token constant">V</span><span class="token operator">*</span>”<span class="token punctuation">,</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token variable">$version</span> <span class="token operator">=</span> <span class="token function">littleEndian</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$prevBlockHash</span> <span class="token operator">=</span> <span class="token function">SwapOrder</span><span class="token punctuation">(</span>’<span class="token number">00000000000008</span>a3a41b85b8b29ad444def299fee21793cd8b9e567eab02cd81′<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$rootHash</span> <span class="token operator">=</span> <span class="token function">SwapOrder</span><span class="token punctuation">(</span>’<span class="token number">2</span>b12fcf1b09288fcaff797d71e950e71ae42b91e8bdb2304758dfcffc2b620e3′<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$time</span> <span class="token operator">=</span> <span class="token function">littleEndian</span><span class="token punctuation">(</span><span class="token number">1305998791</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$bits</span> <span class="token operator">=</span><span class="token function">littleEndian</span><span class="token punctuation">(</span> <span class="token number">440711666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$nonce</span> <span class="token operator">=</span> <span class="token function">littleEndian</span><span class="token punctuation">(</span><span class="token number">2504433986</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//concat it all</span>
<span class="token variable">$header_hex</span> <span class="token operator">=</span> <span class="token variable">$version</span> <span class="token operator">.</span> <span class="token variable">$prevBlockHash</span> <span class="token operator">.</span> <span class="token variable">$rootHash</span> <span class="token operator">.</span> <span class="token variable">$time</span> <span class="token operator">.</span> <span class="token variable">$bits</span> <span class="token operator">.</span> <span class="token variable">$nonce</span><span class="token punctuation">;</span>
<span class="token comment">//convert from hex to binary</span>
<span class="token variable">$header_bin</span>  <span class="token operator">=</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$header_hex</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//hash it then convert from hex to binary</span>
<span class="token variable">$pass1</span> <span class="token operator">=</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span>  <span class="token function">hash</span><span class="token punctuation">(</span>‘sha256′<span class="token punctuation">,</span> <span class="token variable">$header_bin</span> <span class="token punctuation">)</span>  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//Hash it for the seconded time</span>
<span class="token variable">$pass2</span> <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span>‘sha256′<span class="token punctuation">,</span> <span class="token variable">$pass1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//fix the order</span>
<span class="token variable">$FinalHash</span> <span class="token operator">=</span> <span class="token function">SwapOrder</span><span class="token punctuation">(</span><span class="token variable">$pass2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">echo</span>   <span class="token variable">$FinalHash</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h2 id="_5-难度-difficulty" tabindex="-1">5.难度(Difficulty) <a class="header-anchor" href="#_5-难度-difficulty" aria-hidden="true" target="_blank" rel="noopener">#</a></h2><p>​ 难度是对挖矿困难程度的度量，即指：计算符合给定目标的一个 HASH 值的困难程度。比特币网络有一个全局的区块难度，有效的区域必须有一个 HASH 值，该 HASH 值必须小于给定的目标 HASH。矿池也会有一个自定义的共享难度用来设定产生股份的最低难度限制。</p><p>​ 难度每过 2016 块改变一次，计算公式：<code>difficulty = difficulty_1_target / current_target</code>。目标(target)是一个 256 位长的数值。</p><p>​ 有许多不同测量难度的方法，得到的 difficulty_1_target 可能不同。传统地，它表示一个 HASH 值，前 32 位为 0，后续部分为 1(称之为：矿池难度或 pdiff)，比特币协议把目标 HASH 表示成一个固定精度的自定义浮点类型，因而，比特币客户端用该值来估计难度(称之为：bdiff)。</p><p>​ 难度经常被存贮在区块中，每个块存贮一个十六制的目标 HASH 的压缩表达式(称之为：Bits)，目标 HASH 可以以预先定义的公式计算出来。例如：如果区块中压缩的目标 HASH 为 0x1b0404cb，那十六进制的目标 HASH 如下所示：</p><div class="language-"><pre><code>0x0404cb * 2^(8*(0x1b - 3)) = 0x00000000000404CB000000000000000000000000000000000000000000000000
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>因而目标 HASH 为 0x1b0404cb 时，难度为：</p><div class="language-"><pre><code>0x00000000FFFF0000000000000000000000000000000000000000000000000000 /
0x00000000000404CB000000000000000000000000000000000000000000000000
= 16307.420938523983 (bdiff)
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>或者：</p><div class="language-"><pre><code>0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF /
0x00000000000404CB000000000000000000000000000000000000000000000000
= 16307.669773817162 (pdiff)
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>其中：<code>0x00000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF</code> 是挖矿机使用的最大目标 HASH 值。</p><p>而<code>0x00000000FFFF0000000000000000000000000000000000000000000000000000</code>则是比特币网络使用的浮点编码类型，后面的位数被缩短。</p><p>​ 下面是一个快速计算比特币难度的方法，它的算法使用修改的泰勒序列(你可以看 wikipedia 上的教程)，并且依赖记录来转换难度计算。</p><div class="language-cpp line-numbers-mode"><pre><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cmath&gt;</span></span>

<span class="token keyword">inline</span> <span class="token keyword">float</span> <span class="token function">fast_log</span><span class="token punctuation">(</span><span class="token keyword">float</span> val<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">int</span> <span class="token operator">*</span> <span class="token keyword">const</span> exp_ptr <span class="token operator">=</span> <span class="token generic-function"><span class="token function">reinterpret_cast</span> <span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token operator">&amp;</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token operator">*</span>exp_ptr<span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token keyword">int</span> log_2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">&gt;&gt;</span> <span class="token number">23</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">)</span> – <span class="token number">128</span><span class="token punctuation">;</span>
  x <span class="token operator">&amp;=</span> <span class="token operator">~</span><span class="token punctuation">(</span><span class="token number">255</span> <span class="token operator">&lt;&lt;</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  x <span class="token operator">+=</span> <span class="token number">127</span> <span class="token operator">&lt;&lt;</span> <span class="token number">23</span><span class="token punctuation">;</span>
  <span class="token operator">*</span>exp_ptr <span class="token operator">=</span> x<span class="token punctuation">;</span>

  val <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.0f</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> val <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> val – <span class="token number">2.0f</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>val <span class="token operator">+</span> log_2<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.69314718f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">float</span> <span class="token function">difficulty</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> bits<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token keyword">double</span> max_body <span class="token operator">=</span> <span class="token function">fast_log</span><span class="token punctuation">(</span><span class="token number">0x00ffff</span><span class="token punctuation">)</span><span class="token punctuation">,</span> scaland <span class="token operator">=</span> <span class="token function">fast_log</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">exp</span><span class="token punctuation">(</span>max_body – <span class="token function">fast_log</span><span class="token punctuation">(</span>bits <span class="token operator">&amp;</span> <span class="token number">0x00ffffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> scaland <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">0x1d</span> – <span class="token punctuation">(</span><span class="token punctuation">(</span>bits <span class="token operator">&amp;</span> <span class="token number">0xff000000</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">difficulty</span><span class="token punctuation">(</span><span class="token number">0x1b0404cb</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token double-colon punctuation">::</span>endl<span class="token punctuation">;</span>
 <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>如果要看以上一般难度计算的数字原理，以下是 python 代码：</p><div class="language-python line-numbers-mode"><pre><code><span class="token keyword">import</span> decimal<span class="token punctuation">,</span> math
l <span class="token operator">=</span> math<span class="token punctuation">.</span>log
e <span class="token operator">=</span> math<span class="token punctuation">.</span>e

<span class="token keyword">print</span> <span class="token number">0x00ffff</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x1d</span> – <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token number">0x0404cb</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x1b</span> – <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> l<span class="token punctuation">(</span><span class="token number">0x00ffff</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x1d</span> – <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token number">0x0404cb</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x1b</span> – <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> l<span class="token punctuation">(</span><span class="token number">0x00ffff</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x1d</span> – <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> – l<span class="token punctuation">(</span><span class="token number">0x0404cb</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x1b</span> – <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> l<span class="token punctuation">(</span><span class="token number">0x00ffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> l<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x1d</span> – <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> – l<span class="token punctuation">(</span><span class="token number">0x0404cb</span><span class="token punctuation">)</span> – l<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x1b</span> – <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> l<span class="token punctuation">(</span><span class="token number">0x00ffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x1d</span> – <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>l<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> – l<span class="token punctuation">(</span><span class="token number">0x0404cb</span><span class="token punctuation">)</span> – <span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x1b</span> – <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>l<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> l<span class="token punctuation">(</span><span class="token number">0x00ffff</span> <span class="token operator">/</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token number">0x0404cb</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x1d</span> – <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>l<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> – <span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">0x1b</span> – <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>l<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> l<span class="token punctuation">(</span><span class="token number">0x00ffff</span> <span class="token operator">/</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token number">0x0404cb</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">0x1d</span> – <span class="token number">0x1b</span><span class="token punctuation">)</span><span class="token operator">*</span>l<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">8</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>​ 目前难度可以通过<a href="http://blockexplorer.com/q/getdifficulty" target="_blank" rel="noopener noreferrer">http://blockexplorer.com/q/getdifficulty</a>来得到，下一个难度可以通过<a href="http://blockexplorer.com/q/estimate" target="_blank" rel="noopener noreferrer">http://blockexplorer.com/q/estimate</a> 来获得。难度的变化情况可以查看<a href="http://bitcoin.sipa.be/" target="_blank" rel="noopener noreferrer">http://bitcoin.sipa.be/</a>。</p><p>​ 最大难度大约=maximum_target / 1 (因为 0 会导致无穷大)，这是一个非常大的数值，大约 2^224；当 maximum_target 为最小 1 时，最小难度值为 1。</p><p>​ 难度根据以前 2016 个区块的产生时间，每 2016 块改变一次。预计每隔 10 分钟产生一个区块，因而产生 2016 个区块要花费 2 周时间。如果前 2016 个区块的产生时间多于两周，则难度会降低；否则难度就会增加。</p><p>​ 为了找到新区块，该区块的 HASH 值必须小于目标 HASH 傎，实际上是一个在 0 到 2^256-1 之间的随机数，难度 1 的偏移量是：</p><div class="language-"><pre><code>0xffff * 2^208
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>难度 D 的偏移量是</p><div class="language-"><pre><code>(0xffff * 2^208)/D
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在难度 D 下，为了找到新区块，我们预期要计算的 HASH 数量是</p><div class="language-"><pre><code>D * 2^256 / (0xffff * 2^208)
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>或者只是</p><div class="language-"><pre><code>D * 2^48 / 0xffff
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>​ 难度的设定，是为了以每 10 分钟一个区块的产生速度产生 2016 个区块，因而我们在 600 秒内计算 (D * 2^48 / 0xffff) 个 HASH，这就意味着产生 2016 个区块的网络 HASH 速率(算力)是</p><div class="language-"><pre><code>D * 2^48 / 0xffff / 600
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>可以进一步简化为：</p><div class="language-"><pre><code>D * 2^32 / 600
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>以上公式有较好的精度。</p><p>​ 在难度 1 下，算力是 7Mhashes/秒，译者在翻译这篇文章时难度是 5,006,860,589，这就意味着以前 2016 个区块被找到，其平均算力是：35.840PHash/s。</p><div class="language-"><pre><code>5,006,860,589 * 2^32 / 600 = 大约在35.840 PHash/s
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>发现一个区块的平均时间，可以用以下公式估计：</p><div class="language-"><pre><code>时间 = 难度 * 2^32 / 算力
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>​ 其中，难度是当前的难度，算力你的矿机的计算能力，是 hashes/s 为单位，时间是你找到的两个区块之间的平均时间。举例：使用 Python 计算，算力为 1Ghashes/s 的矿机，难度在 20000 时，产生一个新区块的时间，(其中**表示指数)：</p><div class="language-"><pre><code>$ python -c &quot;print 20000 * 2**32 / 10**9 / 60 / 60.0&quot;
23.85
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>意思就是：找到一个新区块要花费近 1 小时。</p><p><a href="https://en.bitcoin.it/wiki/Mining_Hardware_Comparison" target="_blank" rel="noopener noreferrer">挖矿硬件对比</a>，这里有一些统计，可以帮助你预测收入。</p><p><a href="http://www.alloscomp.com/bitcoin/calculator.php" target="_blank" rel="noopener noreferrer">收支计算器 1</a>，<a href="http://www.vnbitcoin.org/bitcoincalculator.php" target="_blank" rel="noopener noreferrer">收支计算器 2</a>，能帮你计算收支。</p><p>记住：这只是可能性，并不能保证你每天都能找到新区块。建议加入矿池挖矿，通过共享区块收益的方式，能得到稳定长期的回报。</p><h2 id="本文译自比特币-wiki" tabindex="-1">本文译自比特币 WIKI <a class="header-anchor" href="#本文译自比特币-wiki" aria-hidden="true" target="_blank" rel="noopener">#</a></h2><ul><li><a href="https://en.bitcoin.it/wiki/Block_chain" target="_blank" rel="noopener noreferrer">https://en.bitcoin.it/wiki/Block_chain</a></li><li><a href="https://en.bitcoin.it/wiki/Block" target="_blank" rel="noopener noreferrer">https://en.bitcoin.it/wiki/Block</a></li><li><a href="https://en.bitcoin.it/wiki/Block_hashing_algorithm" target="_blank" rel="noopener noreferrer">https://en.bitcoin.it/wiki/Block_hashing_algorithm</a></li><li><a href="https://en.bitcoin.it/wiki/Genesis_block" target="_blank" rel="noopener noreferrer">https://en.bitcoin.it/wiki/Genesis_block</a></li><li><a href="https://en.bitcoin.it/wiki/Nonstandard_block" target="_blank" rel="noopener noreferrer">https://en.bitcoin.it/wiki/Nonstandard_block</a></li><li><a href="https://en.bitcoin.it/wiki/Difficulty" target="_blank" rel="noopener noreferrer">https://en.bitcoin.it/wiki/Difficulty</a></li><li><a href="https://en.bitcoin.it/wiki/Target" target="_blank" rel="noopener noreferrer">https://en.bitcoin.it/wiki/Target</a></li></ul></div></div><footer class="page-footer" data-v-3343bde8 data-v-4b1dabee><div class="edit" data-v-4b1dabee><div class="edit-link" data-v-4b1dabee data-v-8bf3d9b4><!----></div></div><div class="updated" data-v-4b1dabee><!----></div></footer><!----><!--[--><!--]--></div></main></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"readme.md\":\"3bf6d415\",\"blogs_ammandliquiditypool.md\":\"57bcf4c6\",\"blogs_btcminning.md\":\"4f90b0e4\",\"blogs_ethstratum.md\":\"b9e35113\",\"blogs_fixedrateincomeagreement.md\":\"6056da72\",\"blogs_floatcapital.md\":\"31850f08\",\"blogs_olympusdao.md\":\"72b206bd\",\"defi_nftdefi.md\":\"36ed5d57\",\"defi_ohmcalc.md\":\"8a71bdda\",\"defi_timecalc.md\":\"1ab7bffb\",\"index.md\":\"27734208\",\"other_contact.md\":\"2802b674\",\"other_qa.md\":\"004391c5\",\"other_story.md\":\"04c4518b\",\"other_teams.md\":\"bdde64dd\",\"pool_epik-f019807.md\":\"d1cb28a3\",\"pool_epik-f052187.md\":\"45cc821c\",\"pool_epik-f082279.md\":\"eb484f7c\",\"pool_epik-f089847.md\":\"75b7ac31\",\"products_compare.md\":\"5d802e27\",\"products_filecoin.md\":\"d764f46d\",\"products_product1.md\":\"6671a242\",\"products_product2.md\":\"b9a54510\",\"products_product3.md\":\"b3b08dfc\",\"service_intro.md\":\"eed22681\",\"service_solution1.md\":\"e12fc1ea\",\"service_solution2.md\":\"b1e711cf\"}")</script>
    <script type="module" async src="/assets/app.99e6884a.js"></script>
    
  </body>
</html>